changed a few things in the code to remove redundent stuff.

check notes in the js file, they are marked with what I removed